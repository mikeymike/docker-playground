#!/bin/bash

envsubst < "/usr/local/etc/php/conf.d/php-xdebug.template" > "/usr/local/etc/php/conf.d/php-xdebug.ini"
envsubst < "/usr/local/etc/php/conf.d/php-custom.template" > "/usr/local/etc/php/conf.d/php-custom.ini"

rm /usr/local/etc/php/conf.d/php-xdebug.template
rm /usr/local/etc/php/conf.d/php-custom.template
rm /etc/msmtprc.template

[ "$XDEBUG_ENABLE" = "true" ] && \
    docker-php-ext-enable xdebug && \
    echo "Xdebug is enabled"

composer install -o --no-interaction

exec "$@"
